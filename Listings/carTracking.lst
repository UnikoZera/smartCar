C51 COMPILER V9.54   CARTRACKING                                                           12/01/2024 17:54:51 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE CARTRACKING
OBJECT MODULE PLACED IN .\Objects\carTracking.obj
COMPILER INVOKED BY: D:\mcu\Keil5\C51\BIN\C51.EXE carTracking.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\carTracking.lst) OBJECT(.\Objects\carTracking.obj)

line level    source

   1          #include <REGX52.H>
   2          #include <intrins.h>
   3          #include "carMovement.h"
   4          
   5          sbit Left_0 =   P0^4;
   6          sbit Left_1 =   P0^5;
   7          sbit Middle_0 = P0^3; 
   8          sbit Middle_1 = P0^2; 
   9          sbit Right_0 =  P0^1;
  10          sbit Right_1 =  P0^0;
  11          
  12          unsigned char valueState = 0;
  13          unsigned char previousStates = 0;
  14          unsigned char Crossroads = 0;
  15          void Delay100us(void)   //@11.0592MHz
  16          {
  17   1              unsigned char data i;
  18   1      
  19   1              _nop_();
  20   1              i = 43;
  21   1              while (--i);
  22   1      }
  23          
  24          void Delay1000ms(void)  //@11.0592MHz
  25          {
  26   1              unsigned char data i, j, k;
  27   1      
  28   1              _nop_();
  29   1              i = 8;
  30   1              j = 1;
  31   1              k = 243;
  32   1              do
  33   1              {
  34   2                      do
  35   2                      {
  36   3                              while (--k);
  37   3                      } while (--j);
  38   2              } while (--i);
  39   1      }
  40          
  41          //黑线是1，白线是0
  42          void ChangeState() //调整小车冲出赛道的状态
  43          {
  44   1          carStop();
  45   1          if (previousStates == 0)
  46   1          {
  47   2              carMoveBackward();
  48   2          }
  49   1          else if (previousStates == 1)
  50   1          {
  51   2              carSharpRight();
  52   2          }
  53   1          else if (previousStates == 2)
  54   1          {
C51 COMPILER V9.54   CARTRACKING                                                           12/01/2024 17:54:51 PAGE 2   

  55   2              carSharpLeft();
  56   2          }
  57   1      }
  58          
  59          void Tracking()
  60          {
  61   1          if (valueState != States)   /*记忆上一次的状态*/
  62   1          {
  63   2              Delay100us();
  64   2              previousStates = valueState;
  65   2              valueState = States;
  66   2          }
  67   1          //左边检查到黑线，但是右边nil
  68   1          if ((Left_0 == 1 || Left_1 == 1 || Middle_0 == 1) && (Right_0 == 0 && Middle_1 == 0 && Right_1 == 0))
  69   1          {
  70   2              if (Left_0 == 1)
  71   2              {
  72   3                  carTurnLeft(3);
  73   3              }
  74   2              else if (Left_1 == 1)
  75   2              {
  76   3                  carTurnLeft(2);
  77   3              }
  78   2              else if (Middle_0 == 1)
  79   2              {
  80   3                  carTurnLeft(1);
  81   3              }
  82   2          }
  83   1          //右边检查到黑线，但是左边是nil
  84   1          else if ((Left_0 == 0 && Left_1 == 0 && Middle_0 == 0) && (Right_0 == 1|| Middle_1 == 1 || Right_1 == 
             -1))
  85   1          {
  86   2              if (Right_1 == 1)
  87   2              {
  88   3                 carTurnRight(3);
  89   3              }
  90   2              if (Right_0 == 1)
  91   2              {
  92   3                  carTurnRight(2);
  93   3              }
  94   2              else if (Middle_1 == 1)
  95   2              {
  96   3                  carTurnRight(1);
  97   3              }
  98   2          }
  99   1          else if ((Left_0 == 1 && Left_1 == 1 && Middle_0 == 1 && Middle_1 == 1 && Right_0 == 1 && Right_1 == 1
             -) || (Middle_0 == 1 && Middle_1 == 1) || (Middle_0 == 1 && Middle_1 == 1 && Right_0 == 1 && Left_0 == 1))
 100   1          { 
 101   2              carMoveForward(2); //暴力直走
 102   2          }
 103   1          else if ((Left_0 == 0 && Left_1 == 0 && Middle_0 == 0 && Middle_1 == 0 && Right_0 == 0 && Right_1 == 0
             -))
 104   1          {
 105   2              ChangeState();
 106   2          }
 107   1          else
 108   1          {
 109   2              ChangeState();
 110   2          }
 111   1      }
 112          
 113          void CrossroadDetection()
C51 COMPILER V9.54   CARTRACKING                                                           12/01/2024 17:54:51 PAGE 3   

 114          {
 115   1          if ((Left_0 == 1 && Left_1 == 1 && Middle_0 == 1 && Middle_1 == 1 && Right_0 == 1 && Right_1 == 1) || 
             -(Left_1 == 1 && Middle_0 == 1 && Middle_1 == 1 && Right_0 == 1))
 116   1          {
 117   2              Crossroads += 1;
 118   2          }
 119   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    249    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
