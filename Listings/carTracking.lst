C51 COMPILER V9.54   CARTRACKING                                                           12/02/2024 22:10:16 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE CARTRACKING
OBJECT MODULE PLACED IN .\Objects\carTracking.obj
COMPILER INVOKED BY: D:\mcu\Keil5\C51\BIN\C51.EXE carTracking.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\carTracking.lst) OBJECT(.\Objects\carTracking.obj)

line level    source

   1          #include <REGX52.H>
   2          #include <intrins.h>
   3          #include "carMovement.h"
   4          
   5          sbit Left_0 =   P0^4;
   6          sbit Left_1 =   P0^5;
   7          sbit Middle_0 = P0^3; 
   8          sbit Middle_1 = P0^2; 
   9          sbit Right_0 =  P0^1;
  10          sbit Right_1 =  P0^0;
  11          
  12          unsigned char valueState = 0;
  13          unsigned char previousStates = 0;
  14          unsigned char Crossroads = 0;
  15          unsigned char CanCounter = 1;
  16          
  17          //黑线是1，白线是0
  18          void Delay6000ms(void)  //@11.0592MHz
  19          {
  20   1              unsigned char data i, j, k;
  21   1      
  22   1              _nop_();
  23   1              i = 43;
  24   1              j = 6;
  25   1              k = 203;
  26   1              do
  27   1              {
  28   2                      do
  29   2                      {
  30   3                              while (--k);
  31   3                      } while (--j);
  32   2              } while (--i);
  33   1      }
  34          
  35          void Delay100us(void)   //@11.0592MHz
  36          {
  37   1              unsigned char data i;
  38   1      
  39   1              _nop_();
  40   1              i = 43;
  41   1              while (--i);
  42   1      }
  43          
  44          void Delay55ms(void)    //@11.0592MHz
  45          {
  46   1              unsigned char data i, j;
  47   1      
  48   1              i = 99;
  49   1              j = 154;
  50   1              do
  51   1              {
  52   2                      while (--j);
  53   2              } while (--i);
  54   1      }
C51 COMPILER V9.54   CARTRACKING                                                           12/02/2024 22:10:16 PAGE 2   

  55          
  56          
  57          void ChangeState() //调整小车冲出赛道的状态
  58          {
  59   1          States = 5;
  60   1          if (previousStates == 0)
  61   1          {
  62   2              carMoveBackward();
  63   2          }
  64   1          else if (previousStates == 1)
  65   1          {
  66   2              carSharpRight();
  67   2          }
  68   1          else if (previousStates == 2)
  69   1          {
  70   2              carSharpLeft();
  71   2          }
  72   1      }
  73          
  74          void Tracking()
  75          {
  76   1          //左边检查到黑线，但是右边nil
  77   1          if ((Left_0 == 1 || Left_1 == 1 || Middle_0 == 1) && (Right_0 == 0 && Middle_1 == 0 && Right_1 == 0))
  78   1          {
  79   2              if (Left_0 == 1)
  80   2              {
  81   3                  carSharpLeft();
  82   3                  Delay55ms();
  83   3              }
  84   2              else if (Left_1 == 1)
  85   2              {
  86   3                  carTurnLeft(2);
  87   3              }
  88   2              else if (Middle_0 == 1)
  89   2              {
  90   3                  carTurnLeft(1);
  91   3              }
  92   2          }
  93   1          //右边检查到黑线，但是左边是nil
  94   1          else if ((Left_0 == 0 && Left_1 == 0 && Middle_0 == 0) && (Right_0 == 1 || Middle_1 == 1 || Right_1 ==
             - 1))
  95   1          {
  96   2              if (Right_1 == 1)
  97   2              {
  98   3                  carSharpRight(); 
  99   3                  Delay55ms();
 100   3              }
 101   2              else if (Right_0 == 1)
 102   2              {
 103   3                  carTurnRight(2);
 104   3              }
 105   2              else if (Middle_1 == 1)
 106   2              {
 107   3                  carTurnRight(1);
 108   3              }
 109   2          }
 110   1          else if ((Left_0 == 1 && Left_1 == 1 && Middle_0 == 1 && Middle_1 == 1 && Right_0 == 1 && Right_1 == 1
             -) || (Middle_0 == 1 && Middle_1 == 1) || (Middle_0 == 1 && Middle_1 == 1 && Right_0 == 1 && Left_0 == 1))
 111   1          { 
 112   2              carMoveForward(2);
 113   2          }
 114   1          else if ((Left_0 == 0 && Left_1 == 0 && Middle_0 == 0 && Middle_1 == 0 && Right_0 == 0 && Right_1 == 0
C51 COMPILER V9.54   CARTRACKING                                                           12/02/2024 22:10:16 PAGE 3   

             -))
 115   1          {
 116   2              // ChangeState();
 117   2          }
 118   1          else
 119   1          {
 120   2              // ChangeState();
 121   2          }
 122   1      
 123   1          if (valueState != States)
 124   1          {
 125   2              Delay100us();
 126   2          }
 127   1      }
 128          
 129          void CrossroadDetection()
 130          {
 131   1          if (((Left_0 == 1 && Left_1 == 1 && Middle_0 == 1 && Middle_1 == 1 && Right_0 == 1 && Right_1 == 1) ||
             - (Left_1 == 1 && Middle_0 == 1 && Middle_1 == 1 && Right_0 == 1)) && CanCounter == 1)
 132   1          {
 133   2              Crossroads += 1;
 134   2              CanCounter = 0;
 135   2          }
 136   1      
 137   1          if (valueState != States)
 138   1          {
 139   2              previousStates = valueState;
 140   2              valueState = States;
 141   2          }
 142   1      
 143   1          // if (CanCounter == 0)
 144   1          // {
 145   1          //     Delay6000ms();
 146   1          //     CanCounter == 1;
 147   1          // }
 148   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    255    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
