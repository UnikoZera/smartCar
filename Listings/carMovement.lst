C51 COMPILER V9.54   CARMOVEMENT                                                           11/30/2024 15:44:35 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE CARMOVEMENT
OBJECT MODULE PLACED IN .\Objects\carMovement.obj
COMPILER INVOKED BY: D:\mcu\Keil5\C51\BIN\C51.EXE carMovement.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\carMovement.lst) OBJECT(.\Objects\carMovement.obj)

line level    source

   1          #include <REGX52.H>
   2          #include <intrins.h>
   3          
   4          sbit IN1F = P2^0;
   5          sbit IN2F = P2^1;
   6          sbit IN3F = P2^2;
   7          sbit IN4F = P2^3;
   8          sbit IN1B = P2^4;
   9          sbit IN2B = P2^5;
  10          sbit IN3B = P2^6;
  11          sbit IN4B = P2^7;
  12          
  13          #define PWM_PERIOD 64
  14          unsigned char dutyCycle1 = 32; //Left
  15          unsigned char dutyCycle2 = 32; //Right
  16          unsigned char States = 0;
  17          unsigned char Fliping = 0; //1 means enable, 0 means disable
  18          
  19          void Timer0_Init(void)
  20          {
  21   1          TMOD |= 0x01;
  22   1          TH0 = 0xFF;
  23   1          TL0 = 0x00; 
  24   1          ET0 = 1;
  25   1          EA = 1;
  26   1          TR0 = 1;
  27   1      }
  28          
  29          void Timer1_Init(void)
  30          {
  31   1          TMOD |= 0x10;
  32   1          TH1 = 0xFF;
  33   1          TL1 = 0x00; 
  34   1          ET1 = 1;
  35   1          TR1 = 1;
  36   1      }
  37          
  38          void Timer0_ISR(void) interrupt 1
  39          {
  40   1          static unsigned char pwmCounter1 = 0;
  41   1          TH0 = 0xFF;
  42   1          TL0 = 0x00;
  43   1      
  44   1          pwmCounter1++;
  45   1          if (pwmCounter1 >= PWM_PERIOD)
  46   1          {
  47   2              pwmCounter1 = 0;
  48   2          }
  49   1      
  50   1          if (pwmCounter1 < dutyCycle1 && (States != 3 && States != 4))
  51   1          {
  52   2              if (Fliping == 1 && States == 2)
  53   2              {
  54   3                  IN1F = 1;
C51 COMPILER V9.54   CARMOVEMENT                                                           11/30/2024 15:44:35 PAGE 2   

  55   3                  IN2F = 0;
  56   3                  IN1B = 0;
  57   3                  IN2B = 1;
  58   3              }
  59   2              else
  60   2              {
  61   3                  IN1F = 0;
  62   3                  IN2F = 1;
  63   3                  IN1B = 1;
  64   3                  IN2B = 0;
  65   3              }
  66   2          }
  67   1          else if (pwmCounter1 >= dutyCycle1 && (States != 3 && States != 4))
  68   1          {
  69   2              IN1F = 0;
  70   2              IN2F = 0;
  71   2              IN1B = 0;
  72   2              IN2B = 0;
  73   2          }
  74   1      }
  75          
  76          void Timer1_ISR(void) interrupt 3
  77          {
  78   1          static unsigned char pwmCounter2 = 0;
  79   1          TH1 = 0xFF;
  80   1          TL1 = 0x00;
  81   1      
  82   1          pwmCounter2++;
  83   1          if (pwmCounter2 >= PWM_PERIOD)
  84   1          {
  85   2              pwmCounter2 = 0;
  86   2          }
  87   1      
  88   1          if (pwmCounter2 < dutyCycle2 && (States != 3 && States != 4))
  89   1          {
  90   2              if (Fliping == 1 && States == 1)
  91   2              {
  92   3                  IN3F = 0;
  93   3                  IN4F = 1;
  94   3                  IN3B = 0;
  95   3                  IN4B = 1;
  96   3              }
  97   2              else
  98   2              {
  99   3                  IN3F = 1;
 100   3                  IN4F = 0;
 101   3                  IN3B = 1;
 102   3                  IN4B = 0;
 103   3              }
 104   2          }
 105   1          else if (pwmCounter2 >= dutyCycle2 && (States != 3 && States != 4))
 106   1          {
 107   2              IN3F = 0;
 108   2              IN4F = 0;
 109   2              IN3B = 0;
 110   2              IN4B = 0;
 111   2          }
 112   1      }
 113          
 114          void carMoveForward(short int level)
 115          {
 116   1          States = 0;
C51 COMPILER V9.54   CARMOVEMENT                                                           11/30/2024 15:44:35 PAGE 3   

 117   1          if (level == 1)
 118   1          {
 119   2              dutyCycle1 = 16;
 120   2              dutyCycle2 = 16;
 121   2          }
 122   1          else if (level == 2)
 123   1          {
 124   2              dutyCycle1 = 32;
 125   2              dutyCycle2 = 32;
 126   2          }
 127   1          else if (level == 3)
 128   1          {
 129   2              dutyCycle1 = 63;
 130   2              dutyCycle2 = 63;
 131   2          }
 132   1      }
 133          
 134          void carTurnRight(short int level)
 135          {
 136   1              States = 1;
 137   1          if (level == 1)
 138   1          {
 139   2              Fliping = 0;
 140   2              dutyCycle1 = 32;
 141   2              dutyCycle2 = 16;
 142   2          }
 143   1          else if (level == 2)
 144   1          {
 145   2              Fliping = 1;
 146   2              dutyCycle1 = 32;
 147   2              dutyCycle2 = 32;
 148   2          }
 149   1          else if (level == 3)
 150   1          {
 151   2              Fliping = 1;
 152   2              dutyCycle1 = 63;
 153   2              dutyCycle2 = 32;
 154   2          }
 155   1      }
 156          
 157          void carTurnLeft(short int level)
 158          {
 159   1          States = 2;
 160   1          if (level == 1)
 161   1          {
 162   2              Fliping = 0;
 163   2              dutyCycle1 = 16;
 164   2              dutyCycle2 = 32;
 165   2          }
 166   1          else if (level == 2)
 167   1          {
 168   2              Fliping = 1;
 169   2              dutyCycle1 = 32;
 170   2              dutyCycle2 = 32;
 171   2          }
 172   1          else if (level == 3)
 173   1          {
 174   2              Fliping = 1;
 175   2              dutyCycle1 = 32;
 176   2              dutyCycle2 = 63;
 177   2          }
 178   1      }
C51 COMPILER V9.54   CARMOVEMENT                                                           11/30/2024 15:44:35 PAGE 4   

 179          
 180          void carStop()
 181          {
 182   1          States = 3;
 183   1          IN1F = 0;
 184   1          IN2F = 0;
 185   1          IN3F = 0;
 186   1          IN4F = 0;
 187   1          IN1B = 0;
 188   1          IN2B = 0;
 189   1          IN3B = 0;
 190   1          IN4B = 0;
 191   1      }
 192          
 193          void carMoveBackward()
 194          {
 195   1          States = 4;
 196   1              IN1F = 1;
 197   1              IN2F = 0;
 198   1              IN3F = 0;
 199   1              IN4F = 1;
 200   1      
 201   1          IN1B = 0;
 202   1          IN2B = 1;
 203   1          IN3B = 0;
 204   1          IN4B = 1;
 205   1      }
 206          
 207          void carSharpRight()
 208          {
 209   1          States = 5;
 210   1              IN1F = 0;
 211   1              IN2F = 1;
 212   1              IN3F = 0;
 213   1              IN4F = 1;
 214   1      
 215   1          IN1B = 1;
 216   1          IN2B = 0;
 217   1          IN3B = 0;
 218   1          IN4B = 1;
 219   1      }
 220          
 221          void carSharpLeft()
 222          {
 223   1          States = 6;
 224   1              IN1F = 1;
 225   1              IN2F = 0;
 226   1              IN3F = 1;
 227   1              IN4F = 0;
 228   1      
 229   1          IN1B = 0;
 230   1          IN2B = 1;
 231   1          IN3B = 1;
 232   1          IN4B = 0;
 233   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    454    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.54   CARMOVEMENT                                                           11/30/2024 15:44:35 PAGE 5   

   DATA SIZE        =      6    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
